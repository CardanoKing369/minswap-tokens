name: Discord Notifications

on:
  push:
    branches:
      - main
  release:
    types: [published]
  workflow_dispatch:

jobs:
  notify_discord:
    runs-on: ubuntu-latest
    env:
      UPSTREAM_REPO: "https://github.com/minswap/minswap-tokens" 
      REPO_NAME: "minswap-tokens"

    steps:
      - name: Notify Discord on Push
        if: github.event_name == 'push'
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{\"content\": \"ðŸš€ A new push to the repository: ${REPO_NAME}\nCommit: ${GITHUB_SHA}\nCheck it out: ${UPSTREAM_REPO}/commit/${GITHUB_SHA}\"}" \
          ${{ secrets.DISCORD_WEBHOOK }}

      - name: Notify Discord on Release
        if: github.event_name == 'release'
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{\"content\": \"ðŸŽ‰ A new release has been published: ${REPO_NAME}\nRelease: ${GITHUB_REF_NAME}\nCheck it out: ${UPSTREAM_REPO}/releases/latest\"}" \
          ${{ secrets.DISCORD_WEBHOOK }}

      - name: Notify Discord on Manual Trigger
        if: github.event_name == 'workflow_dispatch'
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{\"content\": \"ðŸ›  This workflow was triggered manually for: ${REPO_NAME}\nCheck it out: ${UPSTREAM_REPO}\"}" \
          ${{ secrets.DISCORD_WEBHOOK }}
